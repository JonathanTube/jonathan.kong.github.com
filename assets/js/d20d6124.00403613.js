"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[919],{3905:(n,t,e)=>{e.d(t,{Zo:()=>l,kt:()=>v});var o=e(7294);function r(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function p(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,o)}return e}function s(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?p(Object(e),!0).forEach((function(t){r(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):p(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function a(n,t){if(null==n)return{};var e,o,r=function(n,t){if(null==n)return{};var e,o,r={},p=Object.keys(n);for(o=0;o<p.length;o++)e=p[o],t.indexOf(e)>=0||(r[e]=n[e]);return r}(n,t);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(n);for(o=0;o<p.length;o++)e=p[o],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(n,e)&&(r[e]=n[e])}return r}var i=o.createContext({}),u=function(n){var t=o.useContext(i),e=t;return n&&(e="function"==typeof n?n(t):s(s({},t),n)),e},l=function(n){var t=u(n.components);return o.createElement(i.Provider,{value:t},n.children)},m="mdxType",c={inlineCode:"code",wrapper:function(n){var t=n.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(n,t){var e=n.components,r=n.mdxType,p=n.originalType,i=n.parentName,l=a(n,["components","mdxType","originalType","parentName"]),m=u(e),d=r,v=m["".concat(i,".").concat(d)]||m[d]||c[d]||p;return e?o.createElement(v,s(s({ref:t},l),{},{components:e})):o.createElement(v,s({ref:t},l))}));function v(n,t){var e=arguments,r=t&&t.mdxType;if("string"==typeof n||r){var p=e.length,s=new Array(p);s[0]=d;var a={};for(var i in t)hasOwnProperty.call(t,i)&&(a[i]=t[i]);a.originalType=n,a[m]="string"==typeof n?n:r,s[1]=a;for(var u=2;u<p;u++)s[u]=e[u];return o.createElement.apply(null,s)}return o.createElement.apply(null,e)}d.displayName="MDXCreateElement"},7740:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>c,frontMatter:()=>p,metadata:()=>a,toc:()=>u});var o=e(7462),r=(e(7294),e(3905));const p={},s=void 0,a={unversionedId:"react/Composite Components",id:"react/Composite Components",title:"Composite Components",description:"\u7236\u5b50\u7ec4\u4ef6\u901a\u8baf\u65b9\u5f0f",source:"@site/docs/react/20.Composite Components.md",sourceDirName:"react",slug:"/react/Composite Components",permalink:"/docs/react/Composite Components",draft:!1,editUrl:"https://github.com/JonathanTube/Jonathan.Kong.github.com/tree/main/docs/react/20.Composite Components.md",tags:[],version:"current",sidebarPosition:20,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Hooks customization",permalink:"/docs/react/Hooks customization"},next:{title:"Context",permalink:"/docs/react/Context"}},i={},u=[{value:"\u7236\u5b50\u7ec4\u4ef6\u901a\u8baf\u65b9\u5f0f",id:"\u7236\u5b50\u7ec4\u4ef6\u901a\u8baf\u65b9\u5f0f",level:2},{value:"class component \u793a\u4f8b",id:"class-component-\u793a\u4f8b",level:2},{value:"functional component \u793a\u4f8b",id:"functional-component-\u793a\u4f8b",level:2}],l={toc:u},m="wrapper";function c(n){let{components:t,...e}=n;return(0,r.kt)(m,(0,o.Z)({},l,e,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"\u7236\u5b50\u7ec4\u4ef6\u901a\u8baf\u65b9\u5f0f"},"\u7236\u5b50\u7ec4\u4ef6\u901a\u8baf\u65b9\u5f0f"),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"\u7236\u60f3\u628a\u4fe1\u606f\u4f20\u9012\u7ed9\u5b50 => \u57fa\u4e8e\u5c5e\u6027! !"),(0,r.kt)("li",{parentName:"ul"},"\u5b50\u60f3\u6539\u7236\u7684\u6570\u636e => \u7236\u628a\u4fee\u6539\u81ea\u5df1\u6570\u636e\u7684\u201c\u65b9\u6cd5\u201d\uff0c\u57fa\u4e8e\u201c\u5c5e\u6027\u201d\u4f20\u9012\u7ed9\u513f\u5b50\uff0c\u5b50\u6267\u884c\u65b9\u6cd5\u5373\u53ef"),(0,r.kt)("li",{parentName:"ul"},"\u7236\u60f3\u628a\u4e00\u4e9b HTML \u7ed3\u6784\u4f20\u9012\u7ed9\u5b50 => \u57fa\u4e8e\u5c5e\u6027\u4e2d\u7684 children ","[\u63d2\u69fd]"),(0,r.kt)("li",{parentName:"ul"},"\u7236\u518d\u8c03\u7528\u5b50\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u7ed9\u5b50\u8bbe\u7f6e ref\uff0c\u4ee5\u6b64\u83b7\u53d6\u5b50\u7684\u5b9e\u4f8b (\u6216\u8005\u5b50\u4e2d\u66b4\u9732\u7684\u6570\u636e\u548c\u65b9\u6cd5\uff0c\u4f7f\u7528 useImperativeHandle)"))),(0,r.kt)("h2",{id:"class-component-\u793a\u4f8b"},"class component \u793a\u4f8b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'import React from "react"\nimport PropTypes from "prop-types"\n\nclass VoteMain extends React.Component {\n  // \u8bbe\u7f6e\u9ed8\u8ba4\u503c\n  static defaultProps = {\n    supportNum: 0,\n    disapprovalNum: 0,\n  }\n  // \u6821\u9a8c\n  static propTypes = {\n    supportNum: PropTypes.number.isRequired,\n    disapprovalNum: PropTypes.number.isRequired,\n  }\n\n  render() {\n    let { supportNum, disapprovalNum } = this.props\n    let total = supportNum + disapprovalNum\n    let ratio = total === 0 ? 0 : ((supportNum / total) * 100).toFixed(2)\n    return (\n      <div>\n        <div>\u652f\u6301\u6570\uff1a{supportNum}</div>\n        <div>\u53cd\u5bf9\u6570\uff1a{disapprovalNum}</div>\n        <div>\u652f\u6301\u6bd4\u4f8b\uff1a{ratio}%</div>\n      </div>\n    )\n  }\n}\n\n/**\n * \u8fd9\u91cc\u9700\u8981\u4f7f\u7528PureComponent\n * \u56e0\u4e3a\u65b9\u6cd5\u4f20\u9012\u8fdb\u6765\uff0c\u5b50\u7ec4\u4ef6\u6ca1\u6709\u5fc5\u8981\u91cd\u65b0\u6e32\u67d3\n * \u56e0\u4e3a\u7236\u7ec4\u4ef6\u4f7f\u7528\u7684\u7c7b\u7ec4\u4ef6\uff0c\u90a3\u65b9\u6cd5\u4e5f\u662fthis\u4e2d\u7684\uff0c\u6c38\u8fdc\u662f\u540c\u4e00\u4e2a\u65b9\u6cd5\n */\nclass VoteFooter extends React.PureComponent {\n  // \u9ed8\u8ba4\u503c\n  static defaultProps = {\n    support: () => {},\n    disapprove: () => {},\n  }\n  // \u6821\u9a8c\n  static propTypes = {\n    support: PropTypes.func.isRequired,\n    disapprove: PropTypes.func.isRequired,\n  }\n\n  componentDidUpdate() {\n    // \u4f7f\u7528\u4e86PureComponent\u8fd9\u53e5\u8bdd\u4e0d\u4f1a\u6253\u5370\n    console.log("footer component updated")\n  }\n\n  render() {\n    let { support, disapprove } = this.props\n    return (\n      <div>\n        {/* bind\u4e5f\u53ef\u4ee5\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u4f20\u9012\u4e00\u4e9b\u989d\u5916\u503c */}\n        <button onClick={support.bind(this)}>\u652f\u6301</button>\n        &nbsp;\n        {/* \u5b50\u7ec4\u4ef6\u8c03\u7528\u7236\u7ec4\u4ef6\u7684\u65b9\u6cd5 */}\n        <button onClick={disapprove}>\u53cd\u5bf9</button>\n      </div>\n    )\n  }\n}\n\nclass Vote extends React.Component {\n  state = {\n    supportNum: 1,\n    disapprovalNum: 2,\n  }\n\n  support = () => {\n    this.setState({\n      supportNum: this.state.supportNum + 1,\n    })\n  }\n\n  disapprove = () => {\n    this.setState({\n      disapprovalNum: this.state.disapprovalNum + 1,\n    })\n  }\n\n  render() {\n    let { supportNum, disapprovalNum } = this.state\n    return (\n      <div>\n        <div>\u603b\u4eba\u6570\uff1a{supportNum + disapprovalNum}</div>\n        {/* \u7236\u7ec4\u4ef6\u5411\u5b50\u7ec4\u4ef6\u4f20\u9012\u53c2\u6570 */}\n        <VoteMain supportNum={supportNum} disapprovalNum={disapprovalNum} />\n        {/* \u7236\u7ec4\u4ef6\u5411\u5b50\u7ec4\u4ef6\u4f20\u9012\u65b9\u6cd5 */}\n        <VoteFooter support={this.support} disapprove={this.disapprove} />\n      </div>\n    )\n  }\n}\n\nexport default Vote\n')),(0,r.kt)("h2",{id:"functional-component-\u793a\u4f8b"},"functional component \u793a\u4f8b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'import React, { useCallback, useMemo, useState, memo } from "react"\nimport PropTypes from "prop-types"\n\nconst VoteMain = ({ supportNum, disapprovalNum, title }) => {\n  // \u8fd9\u91cc\u505a\u4f18\u5316\uff0c\u5f53\u4e14\u4ec5\u5f53supportNum,\u548cdisapprovalNum\u53d8\u5316\u624d\u91cd\u65b0\u8ba1\u7b97\n  const ratio = useMemo(() => {\n    let total = supportNum + disapprovalNum\n    let ratio = total === 0 ? 0 : ((supportNum / total) * 100).toFixed(2)\n    return ratio\n  }, [supportNum, disapprovalNum])\n  return (\n    <div>\n      <div>\u652f\u6301\u6570\uff1a{supportNum}</div>\n      <div>\u53cd\u5bf9\u6570\uff1a{disapprovalNum}</div>\n      <div>\u652f\u6301\u6bd4\u4f8b\uff1a{ratio}%</div>\n      <div>{title}</div>\n    </div>\n  )\n}\n// \u8bbe\u7f6e\u9ed8\u8ba4\u503c\nVoteMain.defaultProps = {\n  supportNum: 0,\n  disapprovalNum: 0,\n}\n// \u6821\u9a8c\nVoteMain.propTypes = {\n  supportNum: PropTypes.number.isRequired,\n  disapprovalNum: PropTypes.number.isRequired,\n}\n\nconst VoteFooter = memo(({ support, disapprove }) => {\n  console.log("VoteFooter render")\n  return (\n    <div>\n      <button onClick={support}>\u652f\u6301</button>\n      &nbsp;\n      {/* \u5b50\u7ec4\u4ef6\u8c03\u7528\u7236\u7ec4\u4ef6\u7684\u65b9\u6cd5 */}\n      <button onClick={disapprove}>\u53cd\u5bf9</button>\n    </div>\n  )\n})\n\n// \u9ed8\u8ba4\u503c\nVoteFooter.defaultProps = {\n  support: () => {},\n  disapprove: () => {},\n}\n// \u6821\u9a8c\nVoteFooter.propTypes = {\n  support: PropTypes.func.isRequired,\n  disapprove: PropTypes.func.isRequired,\n}\n\nconst Vote = () => {\n  const [supportNum, setSupportNum] = useState(1)\n  const [disapprovalNum, setDisapprovalNum] = useState(1)\n\n  // \u4f7f\u7528useCallback,\u8ba9\u51fd\u6570\u6307\u5411\u5730\u5740\u4e0d\u53d8\n  // \u8fd9\u91cc\u5982\u679c\u8bbe\u7f6edeps=[]\u7684\u8bdd\uff0c\u51fd\u6570\u6c38\u8fdc\u90fd\u662f\u7b2c\u4e00\u6b21\u7684\u521b\u5efa\u7684\u51fd\u6570\n  // \u8fd9\u4e2a\u51fd\u6570\u4f9d\u8d56\u7684\u4e0a\u4e0b\u6587\u7684\u6570\u503c\u6c38\u8fdc\u662f\u521d\u59cb\u5316\u7684supportNum\n  // \u65e0\u8bba\u5982\u4f55\u70b9\u51fb\u90fd\u4e0d\u4f1a\u6709\u6548\u679c\n  const support = useCallback(() => {\n    setSupportNum(supportNum + 1)\n  }, [supportNum])\n\n  //\u4f7f\u7528useCallback,\u8ba9\u51fd\u6570\u6307\u5411\u5730\u5740\u4e0d\u53d8\n  const disapprove = useCallback(() => {\n    setDisapprovalNum(disapprovalNum + 1)\n  }, [disapprovalNum])\n\n  return (\n    <div>\n      <div>\u603b\u4eba\u6570\uff1a{supportNum + disapprovalNum}</div>\n      {/* \u7236\u7ec4\u4ef6\u5411\u5b50\u7ec4\u4ef6\u4f20\u9012\u53c2\u6570 */}\n      <VoteMain\n        title={"\u7b2c\u4e00\u5c4a\u6295\u7968"}\n        supportNum={supportNum}\n        disapprovalNum={disapprovalNum}\n      />\n      {/* \u7236\u7ec4\u4ef6\u5411\u5b50\u7ec4\u4ef6\u4f20\u9012\u65b9\u6cd5 */}\n      <VoteFooter support={support} disapprove={disapprove} />\n    </div>\n  )\n}\n\nexport default Vote\n')))}c.isMDXComponent=!0}}]);